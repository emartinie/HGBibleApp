<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Bible Study App</title>
<style>
  /* Basic reset and fonts */
  body, html {
    margin: 0; padding: 0; font-family: Arial, sans-serif; background: #f9f9f9; color: #222;
  }
  header {
    position: sticky;
    top: 0;
    background: #004080;
    color: white;
    padding: 10px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    z-index: 1000;
  }
  header .logo {
    font-weight: bold;
    font-size: 1.5rem;
  }
  header .week-info {
    flex: 1;
    text-align: center;
    font-size: 1.1rem;
  }
  header button {
    background: #007acc;
    border: none;
    color: white;
    padding: 8px 14px;
    margin: 0 5px;
    cursor: pointer;
    font-size: 1rem;
    border-radius: 4px;
    min-width: 80px;
  }
  header button:disabled {
    background: #555;
    cursor: default;
  }
  main {
    max-width: 900px;
    margin: 20px auto;
    padding: 0 15px;
  }
  section {
    background: white;
    padding: 15px 20px;
    margin-bottom: 20px;
    border-radius: 6px;
    box-shadow: 0 1px 5px rgba(0,0,0,0.1);
  }
  section h2 {
    margin-top: 0;
    border-bottom: 2px solid #004080;
    padding-bottom: 6px;
  }
</style>
</head>
<body>

<header>
  <div class="logo">BibleApp</div>
  <button id="prevWeekBtn" aria-label="Previous Week">Previous</button>
  <div class="week-info" id="weekInfo">Loading Week...</div>
  <button id="nextWeekBtn" aria-label="Next Week">Next</button>
</header>

<main>
  <section id="bibleAppIntro">
    <h2>BibleApp Intro</h2>
    <p>Welcome to the BibleApp! Here’s how it works: each week we provide you with study materials, commentary, and more to deepen your faith journey.</p>
  </section>

  <section id="studyIntro">
    <h2>This Week's Study Intro</h2>
    <div id="studyIntroContent">Loading...</div>
  </section>

  <section id="audioPlayers">
    <h2>Audio Scriptures</h2>
    <div id="audioContent">Loading...</div>
  </section>

  <section id="scripturesList">
    <h2>Scriptures & Theme Verses</h2>
    <div id="scripturesContent">Loading...</div>
  </section>

  <section id="commentary">
    <h2>Commentary</h2>
    <div id="commentaryContent">Loading...</div>
  </section>

  <section id="deeperLearning">
    <h2>Advanced Deeper Learning</h2>
    <div id="deeperLearningContent">Loading...</div>
  </section>

  <section id="alephTavs">
    <h2>Hidden Aleph Tav’s</h2>
    <div id="alephTavsContent">Loading...</div>
  </section>

  <section id="printouts">
    <h2>Printouts & Studies</h2>
    <div id="printoutsContent">Loading...</div>
  </section>

  <section id="kidsCorner">
    <h2>Bible for Kids</h2>
    <div id="kidsCornerContent">Loading...</div>
  </section>

  <section id="wordsOfTheWeek">
    <h2>Words of the Week</h2>
    <div id="wordsOfTheWeekContent">Loading...</div>
  </section>

  <section id="psalmsInAWeek">
    <h2>Psalms in a Week</h2>
    <p>Static section with audio players and texts.</p>
  </section>

  <section id="communityMap">
    <h2>Community Map</h2>
    <p>Interactive Google Map placeholder.</p>
  </section>

  <section id="store">
    <h2>Store</h2>
    <p>Support us by purchasing resources or donating.</p>
  </section>
</main>

<script>
  // Set your start date for week 1 here:
  const START_DATE = new Date("2025-01-05T00:00:00Z");

  // Calculate current week number based on today's date
  function getCurrentWeekNumber() {
    const today = new Date();
    const diffMs = today - START_DATE;
    if(diffMs < 0) return 1; // before start date, default to week 1
    const diffWeeks = Math.floor(diffMs / (1000 * 60 * 60 * 24 * 7)) + 1;
    return diffWeeks;
  }

  // Global current week state
  let currentWeek = getCurrentWeekNumber();

  // UI Elements
  const weekInfoEl = document.getElementById("weekInfo");
  const prevWeekBtn = document.getElementById("prevWeekBtn");
  const nextWeekBtn = document.getElementById("nextWeekBtn");

  // Disable Prev if week 1; disable Next if week 52 (or max)
  function updateButtons() {
    prevWeekBtn.disabled = currentWeek <= 1;
    nextWeekBtn.disabled = currentWeek >= 52;
  }

  // Render dynamic sections from JSON data
  function renderWeek(data) {
    weekInfoEl.textContent = `Week ${data.week}: ${data.english || ''} (${data.transliteration || ''})`;

    document.getElementById("studyIntroContent").innerHTML = data.intro || "(No intro available)";
    
    // Audio Scriptures
    const audioContainer = document.getElementById("audioContent");
    audioContainer.innerHTML = "";
    if(data.audio && data.audio.length) {
      data.audio.forEach(a => {
        const audioEl = document.createElement("audio");
        audioEl.controls = true;
        audioEl.src = a.url;
        audioEl.title = a.title;
        audioContainer.appendChild(audioEl);
        audioContainer.appendChild(document.createElement("br"));
      });
    } else {
      audioContainer.textContent = "(No audio available)";
    }

    // Scriptures & Verses
    const scriptures = data.scriptures || {};
    let scripturesHtml = "";
    if(scriptures.themeVerse) scripturesHtml += `<p><strong>Theme Verse:</strong> ${scriptures.themeVerse}</p>`;
    if(scriptures.memoryVerse) scripturesHtml += `<p><strong>Memory Verse:</strong> ${scriptures.memoryVerse}</p>`;
    ['torah','prophets','gospels','letters'].forEach(cat => {
      if(scriptures[cat] && scriptures[cat].length) {
        scripturesHtml += `<h4>${cat.charAt(0).toUpperCase()+cat.slice(1)}</h4><ul>`;
        scriptures[cat].forEach(ref => {
          scripturesHtml += `<li><a href="${ref.link || '#'}">${ref.ref}</a></li>`;
        });
        scripturesHtml += "</ul>";
      }
    });
    document.getElementById("scripturesContent").innerHTML = scripturesHtml || "(No scriptures available)";

    // Commentary
    document.getElementById("commentaryContent").innerHTML = data.commentary || "(No commentary available)";

    // Deeper Learning
    document.getElementById("deeperLearningContent").innerHTML = data.deeperLearning || "(No deeper learning available)";

    // Hidden Aleph Tavs
    document.getElementById("alephTavsContent").innerHTML = data.hiddenAlephTavs || "(No Aleph Tav notes available)";

    // Printouts & Studies
    const printoutsContainer = document.getElementById("printoutsContent");
    printoutsContainer.innerHTML = "";
    if(data.printouts && data.printouts.length) {
      data.printouts.forEach(item => {
        const link = document.createElement("a");
        link.href = item.url;
        link.textContent = item.title;
        link.target = "_blank";
        printoutsContainer.appendChild(link);
        printoutsContainer.appendChild(document.createElement("br"));
      });
    } else {
      printoutsContainer.textContent = "(No printouts available)";
    }

    // Kids Corner
    const kidsContainer = document.getElementById("kidsCornerContent");
    kidsContainer.innerHTML = "";
    if(data.kidsCorner && data.kidsCorner.length) {
      data.kidsCorner.forEach(item => {
        const link = document.createElement("a");
        link.href = item.url;
        link.textContent = item.title;
        link.target = "_blank";
        kidsContainer.appendChild(link);
        kidsContainer.appendChild(document.createElement("br"));
      });
    } else {
      kidsContainer.textContent = "(No kids corner content)";
    }

    // Words of the Week
    const wordsContainer = document.getElementById("wordsOfTheWeekContent");
    wordsContainer.innerHTML = "";
    if(data.wordsOfTheWeek && data.wordsOfTheWeek.length) {
      data.wordsOfTheWeek.forEach(word => {
        const p = document.createElement("p");
        p.textContent = `${word.hebrew || ''} / ${word.greek || ''} — ${word.meaning || ''}`;
        wordsContainer.appendChild(p);
      });
    } else {
      wordsContainer.textContent = "(No words of the week)";
    }
  }

  // Load JSON for current week and render
  async function loadWeek(weekNum) {
    try {
      const response = await fetch(`/weeks/week${weekNum}.json`);
      if(!response.ok) throw new Error(`Week data not found: week${weekNum}.json`);
      const data = await response.json();
      data.week = weekNum; // fallback if missing
      renderWeek(data);
    } catch (err) {
      weekInfoEl.textContent = `Error loading week ${weekNum}: ${err.message}`;
      console.error(err);
    }
  }

  // Button handlers
  prevWeekBtn.addEventListener("click", () => {
    if(currentWeek > 1) {
      currentWeek--;
      updateButtons();
      loadWeek(currentWeek);
    }
  });

  nextWeekBtn.addEventListener("click", () => {
    if(currentWeek < 52) {
      currentWeek++;
      updateButtons();
      loadWeek(currentWeek);
    }
  });

  // Initial load
  updateButtons();
  loadWeek(currentWeek);
</script>

</body>
</html>
